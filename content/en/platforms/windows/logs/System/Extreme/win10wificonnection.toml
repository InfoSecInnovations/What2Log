#This is the template for What2Log entries

# Meta data about this w2l entry
title = "WiFi Connection" #Name of the log (i.e. User Logon)
tags = ["WiFi Logs", "Windows 10" , "Windows 7"]

description = """\
It is a good idea to monitor what network you machine may be connected \
to at any time. Unusual or public connections can introduce vulnerabilities \
and potentially start a time line of events.
  """

[logging]
service = "Microsoft Windows Security auditing" #Service that generates log
channel = "Security" #Log file or channel
default_enabled = true #true or false
[logging.scripting]
language = "Powershell" #Language for Log Pile
[logging.scripting.tasks]
view = """$xml = @'
<QueryList>
    <Query Id="0" Path="Microsoft-Windows-WLAN-AutoConfig/Operational">
        <Select Path="Microsoft-Windows-WLAN-AutoConfig/Operational">*[System[(EventID=8001)]]
 </Select>
 </Query>
</QueryList>
'@
Get-WinEvent -FilterXM: $xml | select -first 1 | Format-Table -wrap """ #How to view log

# Compliance & framework information

# Format is level and reference under the header [compliance.name]
# Only include relevant frameworks
[compliance.HIPAA]
level = "Recommended" # Compliance requirement
reference = "https://www.hipaajournal.com/patch-update-computer-software-face-hipaa-sanction/" # Reference for compliance
# repeat as needed

[[content]]
img = "/WiFiConnection/WEVMenu.png"
txt = """When a user connects to WiFi, a log is made in the Operational\
log of the WLAN-AutoConfig folder.This folder can be found under the \
Applications and Services Logs folder, and then the Microsoft and \
Windows folder, respectively."""

[[content]]
img = "/WiFiConnection/WEV1.png"
txt = """This log is buried near the bottom, but it holds all the\
information about internet connections made from a machine.\
Event ID 8001 is a successful connection to a wireless network."""

[[content]]
img = "/WiFiConnection/CLI2.png"
txt = """To view a Wireless disconnection log in the command line, launch PowerShell as an administrator.
Because this is an application log, there are two commands that are required to view it from the command line. The first command is
<pre><code>
$xml = @'
&lt;QueryList>
 &lt;Query Id="0" Path="Microsoft-Windows-WLAN-AutoConfig/Operational">
    &lt;Select Path="Microsoft-Windows-WLAN-AutoConfig/Operational">*[System[(EventID=8001)]]</Select>
  &lt;/Query>
&lt;/QueryList>
'@
</pre></code>
After this command is run, the second command to view the log can be run. This command is
<pre><code>Get-WinEvent -FilterXM: $xml | select -first 1 | Format-Table -wrap</code></pre>
The "select -first 1" section of this command returns only the most recent log to save space and can be dropped to view more logs.
However, the "Format-Table -wrap" part of this command is what shows the full log in the command line and should not be dropped.
"""

# repeat as needed
