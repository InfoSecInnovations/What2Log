#This is the template for What2Log entries

# Meta data about this w2l entry
title = "Software Uninstalled" #Name of the log (i.e. User Logon)
tags = ["Application Activity", "Windows 10" , "Windows 7"]

description = """\
Software removal may indicate previously used malicious software being \
taken off a machine or an attempt to disrupt the normal workflow.
  """

[logging]
service = "Service Control Manager" #Service that generates log
channel = "System" #Log file or channel
default_enabled = true #true or false
[logging.scripting]
language = "Powershell" #Language for Log Pile
[logging.scripting.tasks]
view = """Get-WinEvent -FilterHashTable @{LogName='Application';ID='11724'} -MaxEvents 1 | Format-List""" #How to view log

# Compliance & framework information
# Format is level and reference under the header [compliance.name]
# Only include relevant frameworks
[compliance.HIPAA]
level = "Recommended" # Compliance requirement
reference = "https://www.hipaajournal.com/patch-update-computer-software-face-hipaa-sanction/" # Reference for compliance
# repeat as needed

[[content]]
img = "/SoftwareDel/WEV.png"
txt = """
Software removal is logged automatically by windows and logs can \
be viewed in the application tab of the Event Viewer. However, it is important to note \
windows only logs events that are done through the MSInstaller in this log. To view these \
logs, sort or filter by event ID **11724**."""

[[content]]
img = "/SoftwareDel/CLI-gwe.png"
txt = """To view this log in the command line with Get-WinEvent, open PowerShell as an administrator. From here, enter the command ```Get-WinEvent -FilterHashTable @{LogName='Application';ID='11724'} -MaxEvents 1 | Format-List```"""

[[content]]
img = "/SoftwareDel/CLI-wevt.png"
txt = 'To view this log in the command line with wevtutil, open PowerShell or Command Prompt as an administrator. From here, enter the command```wevtutil qe Application "/q:*[System [(EventID=11724)]]" /f:text /c:1```'
# repeat as needed
