#This is the template for What2Log entries

# Meta data about this w2l entry
title = "Process Termination" #Name of the log (i.e. User Logon)
tags = ["Application Activity", "Windows 10", "Windows 7", "Windows 8", "Windows 8.1", "Windows 11"]

description = """\
Applications being closed is a common thing on a computer but may signal \
unusual software being closed or give a timeline of events.
  """

[logging]
service = "Microsoft Windows Security auditing" #Service that generates log
channel = "Security" #Log file or channel
default_enabled = true #true or false
[logging.scripting]
language = "Powershell" #Language for Log Pile
[logging.scripting.tasks]
view = """Get-WinEvent -FilterHashTable @{LogName='Security';ID='4689'} -MaxEvents 1 | Format-List""" #How to view log
check = 'auditpol /get /subcategory:"Process Termination"' #How to check if log is enabled
enable = """auditpol /set /subcategory:"Process Termination" /Success:Enable /Failure:Enable""" #How to enable log
disable = """auditpol /set /subcategory:"Process Termination" /Success:Disable /Failure:Disable""" #How to disable log


# Compliance & framework information
# Format is level and reference under the header [compliance.name]
# Only include relevant frameworks
[compliance.HIPAA]
level = "Recommended" # Compliance requirement
reference = "https://www.hhs.gov/sites/default/files/ocr/privacy/hipaa/administrative/combined/hipaa-simplification-201303.pdf?language=es" # Reference for compliance
[compliance."PCI DSS"]
level = "Recommended" # Compliance requirement
reference = "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf?agreement=true&time=1631643252599"
# repeat as needed

[[content]]
img = "/ProcessTermination/WEV.png"
txt = """To view the process creation log, navigate to the Windows Event Viewer \
and the security tab. Next, sort or filter the log by Event ID **4689**."""

[[content]]
img = "/ProcessTermination/CLI-gwe.png"
txt = """To view this log in the command line with Get-WinEvent, open PowerShell as an administrator. From here, enter the command ```Get-WinEvent -FilterHashTable @{LogName='Security';ID='4689'} -MaxEvents 1 | Format-List```"""

[[content]]
img = "/ProcessTermination/CLI-wevt.png"
txt = 'To view this log in the command line with wevtutil, open PowerShell or Command Prompt as an administrator. From here, enter the command```wevtutil qe Security "/q:*[System [(EventID=4689)]]"```'
