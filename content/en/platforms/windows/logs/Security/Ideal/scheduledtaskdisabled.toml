#This is the template for What2Log entries

# Meta data about this w2l entry
title = "Scheduled Task Disabled"
tags = ["Scheduled Tasks", "Windows 10", "Windows 7", "Windows 8", "Windows 8.1", "Windows 11"]

description = """\
A scheduled task being disabled could be an innocuous thing or it could indicate \
an attacker attempting to either clean up in the wake of an attack or disrupt \
normal operations on a system.
"""

# Additional References Go Here
references = [
"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor"
]# repeat as needed


[logging]
service = "Microsoft Windows Security Auditing"
channel = "Security"
event_id = 4701
default_enabled = false
[logging.scripting]
language = "PowerShell"
[logging.scripting.tasks]
view = """Get-WinEvent -FilterHashTable @{LogName='Security';ID='4701'} -MaxEvents 1 | Format-List"""
check = '''auditpol /get /subcategory:"Other Object Access Events"'''
enable = '''auditpol /set /subcategory:"Other Object Access Events" /Success:Enable /Failure:Enable'''
disable = '''auditpol /set /subcategory:"Other Object Access Events" /Success:Disable /Failure:Disable'''

[[content]]
img = "/ScheduledTasks/Disabled/WEV.png"
txt = "To view this log in the Event Viewer, open the event viewer and navigate to the Windows Logs heading and then the Security Tab. From here, select the find function and search for the value **4701** , or filter the log for the ID **4701**."

[[content]]
img = "/ScheduledTasks/Disabled/CLI-gwe.png"
txt = """To view this log in the command line with Get-WinEvent, open PowerShell as an administrator. From here, enter the command ```Get-WinEvent -FilterHashTable @{LogName='Security';ID='4701'} -MaxEvents 1 | Format-List```"""

[[content]]
txt = 'To view this log in the command line with wevtutil, open PowerShell or Command Prompt as an administrator. From here, enter the command ```wevtutil qe Security "/q:*[System [(EventID=4701)]]" /f:text /c:1```'
# repeat as needed
