#This is the template for What2Log entries

# Meta data about this w2l entry
title = "Group Deletion" #Name of the log (i.e. User Logon)
tags = ["Group Activity", "Windows 10", "Windows 7"]

description = """\
Group deletion may signal the cleanup of an attack or someone trying to \
inconvenience a group of users in a network. It is also good to know what \
groups are present in a system.
  """

# Additional References Go Here
references = [
"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor"
]# repeat as needed

[logging]
service = "Microsoft Windows Security auditing" #Service that generates log
channel = "Security" #Log file or channel
default_enabled = true #true or false
[logging.scripting]
language = "Powershell" #Language for Log Pile
[logging.scripting.tasks]
view = """Get-WinEvent -FilterHashTable @{LogName='Security';ID='4734'} -MaxEvents 1 | Format-List""" #How to view log
check = 'auditpol /get /subcategory:"security group management"' #How to check if log is enabled
enable = """auditpol /set /subcategory:"security group management" /Success:Enable /Failure:Enable""" #How to enable log
disable = """auditpol /set /subcategory:"security group management" /Success:Disable /Failure:Disable""" #How to disable log

[[content]]
img = "/GroupDel/WEV.png"
txt = "Group deletion is automatically logged in Windows 10 and can be viewed in the Event Viewer security tab. To view this log, sort or filter by event ID **4734**."

[[content]]
img = "/GroupDel/CLI-gwe.png"
txt = """To view this log in the command line with Get-WinEvent, open PowerShell as an administrator. From here, enter the command ```Get-WinEvent -FilterHashTable @{LogName='Security';ID='4734'} -MaxEvents 1 | Format-List```"""

[[content]]
img = "/GroupDel/CLI-wevt.png"
txt = 'To view this log in the command line with wevtutil, open PowerShell or Command Prompt as an administrator. From here, enter the command```wevtutil qe Security "/q:*[System [(EventID=4734)]]"```'
# repeat as needed
