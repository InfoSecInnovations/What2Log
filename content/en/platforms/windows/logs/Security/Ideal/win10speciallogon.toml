#This is the template for What2Log entries

# Meta data about this w2l entry
title = "Special Logon" #Name of the log (i.e. User Logon)
tags = ["User Activity", "Windows 10", "Windows 7", "Windows 8", "Windows 8.1", "Windows 11"]

description = """\
  A special logon indicates that a user or process with \
  elevated or administrator privileges has logged onto the system. \
  This log is recommended under HIPAA and PCI DSS for compliance and is \
  recommended by the NSA Event Forwarding Guidance and JPCERT/CC.
  """

# Additional References Go Here
references = [
"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor"
]# repeat as needed

[logging]
service = "Microsoft Windows Security auditing" #Service that generates log
channel = "Security" #Log file or channel
default_enabled = true #true or false
[logging.scripting]
language = "Powershell" #Language for Log Pile
[logging.scripting.tasks]
view = """Get-WinEvent -FilterHashTable @{LogName='Security';ID='4672'} -MaxEvents 1 | Format-List""" #How to view log
check = """auditpol /get /subcategory:"Special Logon""" #How to check if log is enabled
enable = """auditpol /set /subcategory:"Special Logon" /Success:Enable /Failure:Enable""" #How to enable log
disable = """auditpol /set /subcategory:"Special Logon" /Success:Disable /Failure:Disable""" #How to disable log

# Compliance & framework information

# Format is level and reference under the header [compliance.name]
# Only include relevant frameworks
[compliance.HIPAA]
level = "Recommended" # Compliance requirement
reference = "https://www.hhs.gov/sites/default/files/ocr/privacy/hipaa/administrative/combined/hipaa-simplification-201303.pdf?language=es" # Reference for compliance
[compliance."PCI DSS"]
level = "Recommended"
reference = "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf?agreement=true&time=1631643252599"
[compliance."NSA Event Forwarding"]
level = "Recommended"
reference = "https://github.com/nsacyber/Event-Forwarding-Guidance/tree/master/Events"
# repeat as needed

# View via GUI
[[content]]
img = "/SpecialLogon/WEV.png"
txt = "To view this log in the Event Viewer, open the event viewer and navigate to the Windows Logs heading and then the Security Tab. From here, filter the log for the ID **4672**."

[[content]]
img = "/SpecialLogon/CLI-gwe.png"
txt = """To view this log in the command line with Get-WinEvent, open PowerShell as an administrator. From here, enter the command ```Get-WinEvent -FilterHashTable @{LogName='Security';ID='4672'} -MaxEvents 1 | Format-List```"""

[[content]]
img = "/SpecialLogon/CLI-wevt.png"
txt = 'To view this log in the command line with wevtutil, open PowerShell or Command Prompt as an administrator. From here, enter the command```wevtutil qe Security "/q:*[System [(EventID=4672)]]"```'
# repeat as needed
