#This is the template for What2Log entries

# Meta data about this w2l entry
title = "Account Created" #Name of the log (i.e. User Logon)
Tags = ["User Account", "Windows 10", "Windows 7", "Windows 8", "Windows 8.1", "Windows 11"]

description = """\
Account creation logs can indicate a suspicious new account that was \
created in preparation for an attack or someone trying to do things \
they necessarily shouldnâ€™t. It is also a good idea to know when there \
may be new users on the network so you are prepared for their activity. \
This log is required by NIST SP 800-53, HIPAA and PCI DSS regulations. \
It is also recommended under the NSA Cyber Event Forwarding Guidance.
  """

# Additional References Go Here
references = [
"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor",
"https://static1.squarespace.com/static/552092d5e4b0661088167e5c/t/5c586681f4e1fced3ce1308b/1549297281905/Windows+Logging+Cheat+Sheet_ver_Feb_2019.pdf"
]
# repeat as needed

[logging]
service = "Microsoft Windows Security auditing" #Service that generates log
channel = "Security" #Log file or channel
event_id = 4720
default_enabled = true #true or false
[logging.scripting]
language = "Powershell" #Language for Log Pile
[logging.scripting.tasks]
view = """Get-WinEvent -FilterHashTable @{LogName='Security';ID='4720'}""" #How to view log
check = 'auditpol /get /subcategory:"computer account management" ' #How to check if log is enabled
enable = """auditpol /set /subcategory:"computer account management" /Success:Enable /Failure:Enable""" #How to enable log
disable = """auditpol /set /subcategory:"computer account management" /Success:Disable /Failure:Disable""" #How to disable log

# Compliance & framework information

# Format is level and reference under the header [compliance.name]
# Only include relevant frameworks
[compliance.HIPAA]
level = "Recommended" # Compliance requirement
reference = "URL here" # Reference for compliance
[compliance."PCI DSS"]
level = "Required"
reference = "https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss"
[compliace."NSA Event Forwarding"]
level = "Recommended"
reference = "https://github.com/nsacyber/Event-Forwarding-Guidance/tree/master/Events"
[compliance."NIST SP 800-53"]
level = "Recommended"
reference = "URL here"
# repeat as needed

[[content]]
img = "/AccountCreated/WEV.png"
txt = "Windows 10 Professional logs this by default. To view, navigate to the security tab of the Windows Event Viewer. Sort or filter the logs for event ID **4720**."

[[content]]
img = "/AccountCreated/CLI-gwe.png"
txt = """To view this log in the command line with Get-WinEvent, run powershell as an administrator. Enter the command ```Get-WinEvent -FilterHashTable @{LogName='Security';ID='4720'}```"""

[[content]]
img = "/AccountCreated/CLI-wevt.png"
txt = 'To view this log in the command line with wevt, run the command prompt or powershell as an administrator. Enter the command ```wevtutil qe Security "/q:*[System [(EventID=4720)]]"```'
# repeat as needed
