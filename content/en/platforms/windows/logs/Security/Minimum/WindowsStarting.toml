#This is the template for What2Log entries

# Meta data about this w2l entry
title = "Windows Starting Up" #Name of the log (i.e. User Logon)
tags = ["System", "Windows 10", "Windows 7"]

description = """\
The Windows System Starting up is self explanatory in name. It may indicate \
a system being restarted after an attack or to load malicious software. In \
general, it is good to know when systems are being started.
  """

# Additional References Go Here
references = [
"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor"
]# repeat as needed

[logging]
service = "Microsoft Windows Security Auditing" #Service that generates log
channel = "Security" #Log file or channel
default_enabled = true #true or false
[logging.scripting]
language = "Powershell" #Language for Log Pile
[logging.scripting.tasks]
view = """Get-WinEvent -FilterHashTable @{LogName='Security';ID='4608'} -MaxEvents 1 | Format-List""" #How to view log
check = 'auditpol /get /subcategory:"Security State Change"' #How to check if log is enabled
enable = """auditpol /set /subcategory:"Security State Change" /Success:Enable /Failure:Enable""" #How to enable log
disable = """auditpol /set /subcategory:"Security State Change" /Success:Disable /Failure:Disable""" #How to disable log

# Compliance & framework information

# Format is level and reference under the header [compliance.name]
# Only include relevant frameworks
[compliance.HIPAA]
level = "Recommended" # Compliance requirement
reference = "https://www.hhs.gov/sites/default/files/ocr/privacy/hipaa/administrative/combined/hipaa-simplification-201303.pdf?language=es" # Reference for compliance
[compliance."PCI DSS"]
level = "Required"
reference = "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf?agreement=true&time=1631643252599"
[compliance."NSA Event Forwarding"]
level = "Recommended"
reference = "https://github.com/nsacyber/Event-Forwarding-Guidance/tree/master/Events"
# repeat as needed

[[content]]
img = "/WindowsStart/gpe.png"
txt = "In order to enable auditing on Windows starting events, navigate to the System Audit Policies in the group policy editor. Enable 'Security State Change' under the System tab."

[[content]]
img = "/WindowsStart/auditpol.png"
txt = '''This is not logged by default on the Windows system and falls under the "Security State Change" category. In order to turn on auditing for this event, enter the command ```auditpol /set /subcategory:"Security State Change" /Success:Enable /Failure:Enable```'''

[[content]]
img = "/WindowsStart/WEV.png"
txt = "Changes to the audit policy are logged by default in Windows 10 Professional. To view the logs, navigate to the Event Viewer Security tab and sort of filter by Event ID **4608**."

[[content]]
img = "/WindowsStart/CLI-gwe.png"
txt = """To view this log in the command line with Get-WinEvent, open PowerShell as an administrator. From here, enter the command ```Get-WinEvent -FilterHashTable @{LogName='Security';ID='4608'} -MaxEvents 1 | Format-List```"""

[[content]]
img = "/WindowsStart/CLI-wevt.png"
txt = 'To view this log in the command line with wevtutil, open PowerShell or Command Prompt as an administrator. From here, enter the command ```wevtutil qe Security "/q:*[System [(EventID=4608)]]"```'
# repeat as needed
